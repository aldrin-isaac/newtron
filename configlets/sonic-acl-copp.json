{
  "name": "sonic-acl-copp",
  "description": "Control Plane Protection ACLs for SONiC",
  "version": "1.0",
  "variables": [],
  "config_db": {
    "ACL_TABLE": {
      "COPP_TABLE": {
        "policy_desc": "Control Plane Protection",
        "type": "CTRLPLANE",
        "services": "SSH,SNMP,NTP,BGP,DHCP,ICMP"
      }
    },
    "ACL_RULE": {
      "COPP_TABLE|RULE_SSH": {
        "PRIORITY": "9999",
        "PACKET_ACTION": "FORWARD",
        "IP_PROTOCOL": "6",
        "L4_DST_PORT": "22"
      },
      "COPP_TABLE|RULE_BGP": {
        "PRIORITY": "9998",
        "PACKET_ACTION": "FORWARD",
        "IP_PROTOCOL": "6",
        "L4_DST_PORT": "179"
      },
      "COPP_TABLE|RULE_BGP_SRC": {
        "PRIORITY": "9997",
        "PACKET_ACTION": "FORWARD",
        "IP_PROTOCOL": "6",
        "L4_SRC_PORT": "179"
      },
      "COPP_TABLE|RULE_BFD_SINGLE": {
        "PRIORITY": "9996",
        "PACKET_ACTION": "FORWARD",
        "IP_PROTOCOL": "17",
        "L4_DST_PORT": "3784"
      },
      "COPP_TABLE|RULE_BFD_MULTI": {
        "PRIORITY": "9995",
        "PACKET_ACTION": "FORWARD",
        "IP_PROTOCOL": "17",
        "L4_DST_PORT": "4784"
      },
      "COPP_TABLE|RULE_SNMP": {
        "PRIORITY": "9990",
        "PACKET_ACTION": "FORWARD",
        "IP_PROTOCOL": "17",
        "L4_DST_PORT": "161"
      },
      "COPP_TABLE|RULE_NTP": {
        "PRIORITY": "9989",
        "PACKET_ACTION": "FORWARD",
        "IP_PROTOCOL": "17",
        "L4_DST_PORT": "123"
      },
      "COPP_TABLE|RULE_DHCP_SERVER": {
        "PRIORITY": "9985",
        "PACKET_ACTION": "FORWARD",
        "IP_PROTOCOL": "17",
        "L4_SRC_PORT": "67"
      },
      "COPP_TABLE|RULE_DHCP_CLIENT": {
        "PRIORITY": "9984",
        "PACKET_ACTION": "FORWARD",
        "IP_PROTOCOL": "17",
        "L4_DST_PORT": "68"
      },
      "COPP_TABLE|RULE_ICMP_ECHO": {
        "PRIORITY": "9970",
        "PACKET_ACTION": "FORWARD",
        "IP_PROTOCOL": "1",
        "ICMP_TYPE": "8"
      },
      "COPP_TABLE|RULE_ICMP_ECHO_REPLY": {
        "PRIORITY": "9969",
        "PACKET_ACTION": "FORWARD",
        "IP_PROTOCOL": "1",
        "ICMP_TYPE": "0"
      },
      "COPP_TABLE|RULE_ICMP_UNREACHABLE": {
        "PRIORITY": "9968",
        "PACKET_ACTION": "FORWARD",
        "IP_PROTOCOL": "1",
        "ICMP_TYPE": "3"
      },
      "COPP_TABLE|RULE_ICMP_TTL_EXCEEDED": {
        "PRIORITY": "9967",
        "PACKET_ACTION": "FORWARD",
        "IP_PROTOCOL": "1",
        "ICMP_TYPE": "11"
      },
      "COPP_TABLE|RULE_LLDP": {
        "PRIORITY": "9960",
        "PACKET_ACTION": "FORWARD",
        "ETHER_TYPE": "0x88CC"
      },
      "COPP_TABLE|RULE_LACP": {
        "PRIORITY": "9959",
        "PACKET_ACTION": "FORWARD",
        "ETHER_TYPE": "0x8809"
      },
      "COPP_TABLE|RULE_ARP": {
        "PRIORITY": "9950",
        "PACKET_ACTION": "FORWARD",
        "ETHER_TYPE": "0x0806"
      },
      "COPP_TABLE|RULE_ND": {
        "PRIORITY": "9949",
        "PACKET_ACTION": "FORWARD",
        "IP_PROTOCOL": "58"
      }
    },
    "POLICER": {
      "copp_ssh": {
        "meter_type": "packets",
        "mode": "sr_tcm",
        "cir": "600",
        "cbs": "600",
        "red_action": "drop"
      },
      "copp_bgp": {
        "meter_type": "packets",
        "mode": "sr_tcm",
        "cir": "10000",
        "cbs": "10000",
        "red_action": "drop"
      },
      "copp_icmp": {
        "meter_type": "packets",
        "mode": "sr_tcm",
        "cir": "1000",
        "cbs": "1000",
        "red_action": "drop"
      },
      "copp_arp": {
        "meter_type": "packets",
        "mode": "sr_tcm",
        "cir": "4000",
        "cbs": "4000",
        "red_action": "drop"
      }
    }
  },
  "notes": [
    "Control Plane Protection (CoPP) ACLs to protect the CPU from excessive traffic",
    "Allows essential control protocols: BGP, BFD, SSH, SNMP, NTP, DHCP",
    "Allows essential L2 protocols: LLDP, LACP, ARP, IPv6 ND",
    "Policers rate-limit traffic to prevent CPU exhaustion"
  ]
}
