{
    "description": "Inject system MAC into CONFIG_DB and start vlanmgrd/vxlanmgrd (RCA-035)",
    "pre_commands": [
        "for i in $(seq 1 60); do docker ps 2>/dev/null | grep -q ' swss$' && break; sleep 5; done"
    ],
    "post_commands": [
        "MAC=$(python3 -c 'import json,sys;d=json.load(sys.stdin);print(d.get(\"DEVICE_METADATA\",{}).get(\"localhost\",{}).get(\"mac\",\"\"))' < /etc/sonic/config_db.json) && [ -n \"$MAC\" ] && redis-cli -n 4 HSET 'DEVICE_METADATA|localhost' mac \"$MAC\" || true",
        "docker exec swss supervisorctl start vlanmgrd 2>&1 || true",
        "docker exec swss supervisorctl start vxlanmgrd 2>&1 || true"
    ]
}
