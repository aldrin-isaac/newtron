name: loopback-setup
description: |
  Apply sonic-baseline configlet to set hostname and Loopback0 IP on both switches.
  Uses primitive apply-baseline (not provision), so only touches DEVICE_METADATA
  hostname and LOOPBACK_INTERFACE â€” no wipe of CONFIG_DB, no MAC loss.
topology: 2node
requires: [device-init]

steps:
  - name: apply-baseline-both
    action: apply-baseline
    devices: all
    configlet: sonic-baseline

  - name: verify-loopback-switch1
    action: verify-config-db
    devices: [switch1]
    table: LOOPBACK_INTERFACE
    key: "Loopback0"
    expect:
      exists: true

  - name: verify-loopback-switch2
    action: verify-config-db
    devices: [switch2]
    table: LOOPBACK_INTERFACE
    key: "Loopback0"
    expect:
      exists: true
