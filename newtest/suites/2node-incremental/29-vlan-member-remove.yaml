name: vlan-member-remove
description: "VLAN member add and individual remove"
topology: 2node
platform: sonic-vpp
requires: [provision]

steps:
  - name: create-vlan
    action: create-vlan
    devices: [leaf1]
    params:
      vlan_id: 500

  - name: add-member
    action: add-vlan-member
    devices: [leaf1]
    params:
      vlan_id: 500
      interface: Ethernet2

  - name: verify-member-added
    action: verify-config-db
    devices: [leaf1]
    table: VLAN_MEMBER
    key: "Vlan500|Ethernet2"
    expect:
      exists: true

  - name: remove-member
    action: remove-vlan-member
    devices: [leaf1]
    params:
      vlan_id: 500
      interface: Ethernet2

  - name: verify-member-removed
    action: verify-config-db
    devices: [leaf1]
    table: VLAN_MEMBER
    key: "Vlan500|Ethernet2"
    expect:
      exists: false

  - name: cleanup-vlan
    action: delete-vlan
    devices: [leaf1]
    params:
      vlan_id: 500
