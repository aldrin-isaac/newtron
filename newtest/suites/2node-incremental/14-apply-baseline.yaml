name: apply-baseline
description: Apply sonic-baseline configlet and verify CONFIG_DB changes
topology: 2node
requires: [provision]

steps:
  # Apply sonic-baseline configlet to leaf1
  - name: apply-sonic-baseline
    action: apply-baseline
    devices: [leaf1]
    configlet: sonic-baseline

  # Verify hostname was updated in DEVICE_METADATA
  - name: verify-hostname
    action: verify-config-db
    devices: [leaf1]
    table: DEVICE_METADATA
    key: localhost
    expect:
      fields:
        hostname: leaf1

  # Verify the ChangeSet was persisted
  - name: verify-baseline-provisioning
    action: verify-provisioning
    devices: [leaf1]
